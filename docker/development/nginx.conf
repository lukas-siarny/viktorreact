worker_processes                    auto;
error_log                           /dev/stdout info;
pid                                 /run/nginx.pid;

include                             /usr/share/nginx/modules/*.conf;

events {
    worker_connections              1024;
    multi_accept                    on;
}

http {
    log_format                      main    '$remote_addr - $remote_user [$time_local] "$request" '
                                            '$status $body_bytes_sent "$http_referer" '
                                            '"$http_user_agent" "$http_x_forwarded_for"';

    access_log                      /dev/stdout;

	proxy_buffering                 off;
	proxy_redirect                  off;
	proxy_http_version              1.1;
	proxy_set_header                X-Real-IP $remote_addr;
	proxy_set_header                X-Scheme $scheme;
	proxy_set_header                X-Forwarded-For $proxy_add_x_forwarded_for;
	proxy_set_header                Host $host;
	proxy_next_upstream             error timeout invalid_header http_500 http_502 http_503 http_504;

    client_body_buffer_size         10K;
    client_header_buffer_size       1k;
    client_max_body_size            100m;
    large_client_header_buffers     4 32k;
    server_names_hash_bucket_size   64;
    sendfile                        on;
    tcp_nodelay                     on;
    tcp_nopush                      on;
    keepalive_requests              1000;
    reset_timedout_connection       on;
    client_body_timeout             10;
    server_tokens                   off;
    keepalive_timeout               65;
    types_hash_max_size             2048;

    include                         /etc/nginx/mime.types;
    default_type                    application/octet-stream;

    server {
        listen                      8080 default_server;
        server_name                 _;

        charset                     utf-8;
		underscores_in_headers      on;

        root                        /usr/share/nginx/html;

        location /static {
            alias 			        /usr/share/nginx/html/static;
            expires 1y;
            add_header Cache-Control "public";
            access_log off;
        }

        location / {
			alias 			        /usr/share/nginx/html/;
            try_files		        $uri $uri/ /index.html =404;
            add_header Cache-Control "no-store, no-cache, must-revalidate";
        }

        error_page 404 /404.html;
            location = /40x.html {
        }

        error_page 500 502 503 504 /50x.html;
            location = /50x.html {
        }
    }
}
